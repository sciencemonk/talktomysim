
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover, interactive-widget=resizes-content" />
    <title>Sim</title>
    <meta name="description" content="The Web3 AI Agent Platform">
    <meta name="author" content="Sim Project" />
    <meta property="og:image" content="/sim-logo.png?v=2">
    <link rel="icon" href="/sim-logo.png?v=2" type="image/png" sizes="any">
    <link rel="shortcut icon" href="/sim-logo.png?v=2" type="image/png">
    <link rel="apple-touch-icon" href="/sim-logo.png?v=2">
    
  
  
  
  <meta name="twitter:card" content="summary_large_image">
  <meta property="og:type" content="website">
  
  
  
  
  <meta name="twitter:image" content="/sim-logo.png?v=2">
  
  
  
  
  <meta property="og:title" content="Sim">
  <meta name="twitter:title" content="Sim">
  <meta property="og:description" content="The Web3 AI Agent Platform">
  <meta name="twitter:description" content="The Web3 AI Agent Platform">
</head>

  <body>
    <div id="root"></div>
    <!-- IMPORTANT: DO NOT REMOVE THIS SCRIPT TAG OR THIS VERY COMMENT! -->
    <script src="https://cdn.gpteng.co/gptengineer.js" type="module"></script>
    <script type="module" src="/src/main.tsx"></script>
    
    <!-- Detect if we're embedded and hide our own bubble -->
    <script>
      (function() {
        'use strict';
        const urlParams = new URLSearchParams(window.location.search);
        if (urlParams.get('embed') === 'chat-only') {
          const hideBubble = () => {
            const bubble = document.querySelector('[data-sim-bubble], #chat-bubble, .chat-bubble, [id*="bubble"], #sim-chat-bubble');
            if (bubble) {
              bubble.style.display = 'none';
              console.log('[SimAI App] Own bubble hidden (embed=chat-only)');
            }
          };
          
          if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', hideBubble);
          } else {
            hideBubble();
          }
          
          const interval = setInterval(hideBubble, 500);
          setTimeout(() => clearInterval(interval), 5000);
        }
      })();
    </script>
    
    <!-- SimAI Helper Chat Widget -->
    <div id="sim-chat-widget"></div>
    <script>
      (function() {
        'use strict';
        
        // Prevent duplicate initialization
        if (window.__SIM_CHAT_LOADED__ === true) {
          console.log('[SimChat] Already loaded, skipping initialization');
          return;
        }
        
        // Cleanup any existing widgets
        function cleanupExistingWidget() {
          const existingBubble = document.getElementById('sim-chat-bubble');
          const existingWindow = document.getElementById('sim-chat-window');
          const existingStyles = document.getElementById('sim-chat-widget-styles');
          
          if (existingBubble) existingBubble.remove();
          if (existingWindow) existingWindow.remove();
          if (existingStyles) existingStyles.remove();
        }
        
        cleanupExistingWidget();
        window.__SIM_CHAT_LOADED__ = true;

        const simConfig = {
          name: "SimAI Helper",
          avatar: "https://uovhemqkztmkoozlmqxq.supabase.co/storage/v1/object/public/avatars/avatars/5fc73de1-9e91-4e0d-8e4a-f2fc587e7f69-1761073373654.jpg",
          simUrl: "https://ba4e5241-6f09-4c12-a26a-0a6d8ff72241.lovableproject.com/simai-helper?embed=chat-only",
          welcomeMessage: "Hey there! I'm SimAI Helper, your go-to for all things related to SimProject.org—ask me anything about our product, the $SIMAI token, or how to make the most of our platform. Just type your question, and let's get started!"
        };
        
        // Create styles with !important overrides
        const style = document.createElement('style');
        style.id = 'sim-chat-widget-styles';
        style.textContent = `
          #sim-chat-bubble {
            position: fixed !important;
            bottom: 20px !important;
            right: 20px !important;
            width: 60px !important;
            height: 60px !important;
            border-radius: 50% !important;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15) !important;
            cursor: pointer !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
            z-index: 10000 !important;
            transition: transform 0.3s ease !important;
          }
          #sim-chat-bubble:hover {
            transform: scale(1.05) !important;
          }
          #sim-chat-bubble img {
            width: 56px !important;
            height: 56px !important;
            border-radius: 50% !important;
            object-fit: cover !important;
            pointer-events: none !important;
          }
          #sim-chat-window {
            position: fixed !important;
            bottom: 90px !important;
            right: 20px !important;
            width: 380px !important;
            height: 600px !important;
            max-width: calc(100vw - 40px) !important;
            max-height: calc(100vh - 120px) !important;
            border-radius: 12px !important;
            box-shadow: 0 8px 32px rgba(0,0,0,0.2) !important;
            background: white !important;
            z-index: 9999 !important;
            display: none !important;
            flex-direction: column !important;
            overflow: hidden !important;
          }
          #sim-chat-window.active { display: flex !important; }
          #sim-chat-header {
            padding: 16px !important;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%) !important;
            color: white !important;
            display: flex !important;
            align-items: center !important;
            gap: 12px !important;
          }
          #sim-chat-close {
            margin-left: auto !important;
            background: rgba(255,255,255,0.2) !important;
            border: none !important;
            color: white !important;
            width: 32px !important;
            height: 32px !important;
            border-radius: 50% !important;
            cursor: pointer !important;
            font-size: 20px !important;
            display: flex !important;
            align-items: center !important;
            justify-content: center !important;
          }
          #sim-chat-iframe {
            flex: 1 !important;
            border: none !important;
            width: 100% !important;
          }
        `;
        document.head.appendChild(style);
        
        // Create bubble
        const bubble = document.createElement('div');
        bubble.id = 'sim-chat-bubble';
        bubble.innerHTML = `<img src="${simConfig.avatar}" alt="${simConfig.name}" draggable="false">`;
        document.body.appendChild(bubble);
        
        // Create chat window
        const chatWindow = document.createElement('div');
        chatWindow.id = 'sim-chat-window';
        chatWindow.innerHTML = `
          <div id="sim-chat-header">
            <strong>${simConfig.name}</strong>
            <button id="sim-chat-close">×</button>
          </div>
          <iframe 
            id="sim-chat-iframe" 
            src="${simConfig.simUrl}"
            allow="clipboard-write"
            sandbox="allow-scripts allow-same-origin allow-modals allow-forms allow-popups"
            style="pointer-events: auto;"
          ></iframe>
        `;
        document.body.appendChild(chatWindow);
        
        // Block bubble clicks inside iframe
        const iframe = document.getElementById('sim-chat-iframe');
        iframe.onload = function() {
          try {
            const iframeDoc = iframe.contentDocument || iframe.contentWindow.document;
            
            // Inject CSS to hide any floating bubbles inside iframe
            const hideStyle = iframeDoc.createElement('style');
            hideStyle.textContent = `
              [data-sim-bubble], #chat-bubble, .chat-bubble, [id*="bubble"], [class*="bubble"], #sim-chat-bubble {
                display: none !important;
              }
            `;
            iframeDoc.head.appendChild(hideStyle);
            
            console.log('[SimChat] Iframe loaded, bubble hiding CSS injected');
          } catch (e) {
            console.warn('[SimChat] Could not access iframe (CORS protected)', e);
          }
        };
        
        // Toggle chat window on bubble click
        bubble.addEventListener('click', function(e) {
          e.preventDefault();
          e.stopPropagation();
          e.stopImmediatePropagation();
          chatWindow.classList.toggle('active');
          
          // Auto-focus iframe when opening
          if (chatWindow.classList.contains('active')) {
            const iframe = document.getElementById('sim-chat-iframe');
            if (iframe) {
              setTimeout(() => iframe.focus(), 100);
            }
          }
          
          console.log('[SimChat] Bubble clicked, chat window toggled');
        });
        
        // Close button
        const closeBtn = document.getElementById('sim-chat-close');
        if (closeBtn) {
          closeBtn.addEventListener('click', function(e) {
            e.preventDefault();
            e.stopPropagation();
            e.stopImmediatePropagation();
            chatWindow.classList.remove('active');
            console.log('[SimChat] Close button clicked');
          });
        }
        
        // Escape key to close
        document.addEventListener('keydown', function(e) {
          if (e.key === 'Escape' && chatWindow.classList.contains('active')) {
            chatWindow.classList.remove('active');
            console.log('[SimChat] Closed via Escape key');
          }
        });
        
        // Click outside to close
        document.addEventListener('click', function(e) {
          if (chatWindow.classList.contains('active') && 
              !chatWindow.contains(e.target) && 
              !bubble.contains(e.target)) {
            chatWindow.classList.remove('active');
            console.log('[SimChat] Closed via click outside');
          }
        });
        
        console.log('[SimChat] Widget initialized successfully');
      })();
    </script>
  </body>
</html>
